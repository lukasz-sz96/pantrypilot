[supervisord]
nodaemon=true
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
user=root

[program:convex-backend]
command=/usr/local/bin/convex-local-backend --port 3210 --site-proxy-port 3211
directory=/convex/data
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=1

[program:convex-dashboard]
command=node /app/convex-dashboard/server.js
directory=/app/convex-dashboard
environment=PORT="6791",NEXT_PUBLIC_DEPLOYMENT_URL="http://localhost:3210"
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=2

[program:cooklang-import]
command=uvicorn server:app --host 0.0.0.0 --port 8080
directory=/app/cooklang-import
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=3

[program:app]
command=node /app/dist/server/server.js
directory=/app
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=4
startsecs=5
